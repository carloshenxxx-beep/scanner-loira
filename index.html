<!doctype html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Verifica√ß√£o de Compatibilidade‚Ñ¢</title>
  <style>
    :root{
      --bg:#06060f;
      --card: rgba(255,255,255,.06);
      --card2: rgba(255,255,255,.085);
      --line: rgba(255,255,255,.12);
      --txt: rgba(255,255,255,.93);
      --muted: rgba(255,255,255,.66);
      --accent: #6d5cff;
      --accent2:#22c55e;
      --warn:#ffcc00;
      --danger:#ff3b30;
      --shadow: 0 25px 90px rgba(0,0,0,.65);
      --radius: 20px;
      --mono: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
      --sans: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial;
    }
    *{box-sizing:border-box}
    body{
      margin:0;
      min-height:100svh;
      font-family: var(--sans);
      color: var(--txt);
      background:
        radial-gradient(900px 620px at 12% 12%, rgba(109,92,255,.22), transparent 60%),
        radial-gradient(900px 620px at 88% 82%, rgba(34,197,94,.14), transparent 58%),
        radial-gradient(800px 520px at 70% 20%, rgba(255,204,0,.10), transparent 55%),
        var(--bg);
      display:grid;
      place-items:center;
      padding:16px;
      overflow-x:hidden;
    }

    /* part√≠culas */
    .fx{
      position:fixed; inset:0; pointer-events:none;
      background:
        radial-gradient(1px 1px at 20% 30%, rgba(255,255,255,.30), transparent 60%),
        radial-gradient(1px 1px at 60% 10%, rgba(255,255,255,.22), transparent 60%),
        radial-gradient(1px 1px at 80% 40%, rgba(255,255,255,.20), transparent 60%),
        radial-gradient(1px 1px at 15% 75%, rgba(255,255,255,.18), transparent 60%),
        radial-gradient(1px 1px at 55% 85%, rgba(255,255,255,.20), transparent 60%);
      opacity:.6;
      animation: floaty 7s ease-in-out infinite alternate;
    }
    @keyframes floaty{
      from{transform: translateY(0)}
      to{transform: translateY(-10px)}
    }

    .app{
      width: min(460px, 100%);
      border-radius: 28px;
      border:1px solid rgba(255,255,255,.14);
      background: linear-gradient(180deg, rgba(255,255,255,.09), rgba(255,255,255,.06));
      box-shadow: var(--shadow);
      overflow:hidden;
      position:relative;
    }

    header{
      display:flex;
      justify-content:space-between;
      align-items:center;
      gap:10px;
      padding:14px 14px 12px;
      border-bottom: 1px solid rgba(255,255,255,.12);
      background: rgba(0,0,0,.18);
      backdrop-filter: blur(10px);
    }
    .brand{min-width:0}
    .brand b{
      display:block;
      font-size:13px;
      letter-spacing:.2px;
      white-space:nowrap; overflow:hidden; text-overflow:ellipsis;
    }
    .brand span{
      display:block;
      margin-top:2px;
      font-family: var(--mono);
      font-size:11px;
      color: var(--muted);
      white-space:nowrap; overflow:hidden; text-overflow:ellipsis;
    }
    .pill{
      font-family: var(--mono);
      font-size:11px;
      padding:7px 10px;
      border-radius:999px;
      border:1px solid rgba(255,255,255,.14);
      background: rgba(255,255,255,.08);
      color: rgba(255,255,255,.85);
      user-select:none;
      white-space:nowrap;
    }

    main{padding:14px}
    .screen{display:none; animation: in .18s ease both}
    .screen.active{display:block}
    @keyframes in{from{opacity:0; transform: translateY(12px)} to{opacity:1; transform: translateY(0)}}

    .card{
      border:1px solid rgba(255,255,255,.12);
      background: rgba(0,0,0,.18);
      border-radius: var(--radius);
      padding:14px;
    }
    .kicker{
      font-family: var(--mono);
      font-size:11px;
      color: var(--muted);
      margin-bottom:10px;
    }
    h1,h2{margin:0 0 10px}
    h1{font-size:18px; font-weight:900}
    h2{font-size:15px; font-weight:900}
    p{margin:8px 0; color: rgba(255,255,255,.83); line-height:1.45}

    .grid2{display:grid; grid-template-columns: 1fr 1fr; gap:10px}
    .tile{
      border:1px solid rgba(255,255,255,.10);
      background: rgba(255,255,255,.05);
      border-radius: 18px;
      padding:12px;
    }
    .tile b{display:block; font-size:13px}
    .tile small{display:block; margin-top:4px; font-family:var(--mono); color:rgba(255,255,255,.60); font-size:11px}

    label{
      display:flex;
      justify-content:space-between;
      color: var(--muted);
      font-size:12px;
      margin-top:10px;
    }
    input, select{
      width:100%;
      margin-top:8px;
      padding:12px 12px;
      border-radius: 14px;
      border:1px solid rgba(255,255,255,.14);
      background: rgba(0,0,0,.22);
      color: var(--txt);
      outline:none;
      font-size:14px;
    }
    input::placeholder{color: rgba(255,255,255,.35)}
    .hint{margin-top:8px; font-family:var(--mono); font-size:11px; color: rgba(255,255,255,.58)}

    .btns{display:flex; gap:10px; margin-top:12px}
    button{
      width:100%;
      padding:12px 14px;
      border-radius: 14px;
      border:1px solid rgba(255,255,255,.14);
      background: rgba(255,255,255,.09);
      color: rgba(255,255,255,.92);
      font-weight:900;
      cursor:pointer;
      transition: transform .08s ease, filter .15s ease;
      box-shadow: 0 12px 30px rgba(0,0,0,.25);
    }
    button:active{transform: translateY(1px)}
    .primary{
      background: linear-gradient(180deg, rgba(109,92,255,.95), rgba(89,70,230,.95));
      border-color: rgba(109,92,255,.45);
    }
    .good{
      background: linear-gradient(180deg, rgba(34,197,94,.85), rgba(22,163,74,.85));
      border-color: rgba(34,197,94,.40);
    }
    .ghost{background: rgba(255,255,255,.06)}
    .danger{background: rgba(255,59,48,.16); border-color: rgba(255,59,48,.35)}

    .progress{
      height: 12px;
      border-radius: 999px;
      border:1px solid rgba(255,255,255,.12);
      background: rgba(255,255,255,.06);
      overflow:hidden;
      margin-top:12px;
    }
    .bar{
      height: 100%;
      width: 0%;
      background: linear-gradient(90deg, rgba(34,197,94,.95), rgba(109,92,255,.95));
      transition: width .35s ease;
    }

    .terminal{
      margin-top:12px;
      border-radius: 18px;
      border:1px solid rgba(255,255,255,.12);
      background: linear-gradient(180deg, rgba(255,255,255,.06), rgba(0,0,0,.12));
      padding:12px;
      font-family: var(--mono);
      font-size: 12px;
      line-height:1.42;
      min-height: 150px;
      white-space: pre-wrap;
      position:relative;
      overflow:hidden;
    }
    .scanline{
      position:absolute; left:0; right:0; height:2px;
      background: rgba(255,204,0,.90);
      box-shadow: 0 0 18px rgba(255,204,0,.30);
      top: -3px;
      animation: scan 1.2s linear infinite;
      opacity:.9;
    }
    @keyframes scan{
      0%{transform: translateY(0)}
      100%{transform: translateY(260px)}
    }

    .tag{opacity:.95}
    .ok{color: rgba(34,197,94,.95)}
    .warn{color: rgba(255,204,0,.95)}
    .err{color: rgba(255,59,48,.95)}

    .kpis{display:flex; flex-direction:column; gap:10px; margin-top:12px}
    .kpi{
      display:flex; gap:10px; align-items:flex-start;
      padding:10px 12px;
      border-radius:16px;
      border:1px solid rgba(255,255,255,.10);
      background: rgba(255,255,255,.05);
    }
    .kpi .ico{
      width:30px; height:30px; border-radius:12px;
      display:grid; place-items:center;
      border:1px solid rgba(255,255,255,.12);
      background: rgba(255,255,255,.08);
      flex:0 0 auto;
    }
    .kpi b{font-weight:900}
    .kpi small{display:block; margin-top:2px; color: rgba(255,255,255,.62); font-family:var(--mono); font-size:11px}

    .gallery{
      display:grid;
      grid-template-columns: repeat(2, 1fr);
      gap:10px;
      margin-top:12px;
    }
    .ph{
      border-radius: 18px;
      border:1px solid rgba(255,255,255,.12);
      overflow:hidden;
      background: rgba(255,255,255,.06);
      aspect-ratio: 1 / 1;
      position:relative;
    }
    .ph img{width:100%; height:100%; object-fit:cover; display:block}
    .ph span{
      position:absolute; left:10px; right:10px; bottom:10px;
      padding:8px 10px;
      border-radius:999px;
      background: rgba(0,0,0,.40);
      border:1px solid rgba(255,255,255,.12);
      backdrop-filter: blur(6px);
      font-size:11px;
      color: rgba(255,255,255,.90);
    }

    /* modal (mensagens/alertas) */
    .modal{
      position:fixed; inset:0;
      display:none;
      place-items:center;
      padding:16px;
      background: rgba(0,0,0,.72);
      z-index:99;
    }
    .modal.show{display:grid}
    .pop{
      width:min(460px, 100%);
      border-radius:18px;
      border:1px solid rgba(255,255,255,.14);
      background: rgba(10,10,14,.92);
      box-shadow: var(--shadow);
      overflow:hidden;
    }
    .pop header{
      border-bottom:1px solid rgba(255,255,255,.12);
      background: rgba(255,255,255,.04);
    }
    .pop .head{
      padding:12px 14px 10px;
    }
    .pop .head b{display:block; font-size:13px}
    .pop .head span{display:block; margin-top:2px; font-family:var(--mono); font-size:11px; color: rgba(255,255,255,.62)}
    .pop main{padding:14px}
    .pop p{margin:0}
    .shake{animation: shake .22s ease}
    @keyframes shake{0%,100%{transform:translateX(0)} 25%{transform:translateX(-7px)} 75%{transform:translateX(7px)}}

    /* youtube reveal */
    .ytWrap{
      margin-top:12px;
      border-radius: 18px;
      overflow:hidden;
      border:1px solid rgba(255,255,255,.12);
      background: rgba(255,255,255,.06);
      display:none;
    }
    .ytWrap iframe{width:100%; height:240px; border:0; display:block}

    footer{
      padding: 10px 14px 14px;
      border-top:1px solid rgba(255,255,255,.12);
      background: rgba(0,0,0,.16);
      font-family: var(--mono);
      font-size: 11px;
      color: rgba(255,255,255,.55);
      display:flex;
      justify-content:space-between;
      gap:10px;
    }
  </style>
</head>

<body>
  <div class="fx"></div>

  <div class="app">
    <header>
      <div class="brand">
        <b>Verifica√ß√£o de Compatibilidade‚Ñ¢</b>
        <span id="sub">alvo: Loira ‚Ä¢ protocolo: sorriso</span>
      </div>
      <div class="pill" id="pill">STATUS: <span id="st">IDLE</span></div>
    </header>

    <main>
      <!-- S1: splash -->
      <section class="screen active" id="s1">
        <div class="card">
          <div class="kicker">BOOT ‚Üí carregar_sinceridade()</div>
          <h1>Oi‚Ä¶ üòå</h1>
          <p>Eu fiz isso de um jeito diferente porque <b>tem coisas que eu n√£o queria dizer de forma comum</b>.</p>

          <div class="grid2" style="margin-top:12px">
            <div class="tile">
              <b>Seguran√ßa</b>
              <small>Criptografia: carinho</small>
            </div>
            <div class="tile">
              <b>Objetivo</b>
              <small>Arrancar um sorriso</small>
            </div>
            <div class="tile">
              <b>Precis√£o</b>
              <small>Alta (me conhe√ßo)</small>
            </div>
            <div class="tile">
              <b>Resultado</b>
              <small>Surpresa no final</small>
            </div>
          </div>

          <div class="btns">
            <button class="primary" id="start">INICIAR</button>
            <button class="ghost" id="secret">bot√£o proibido</button>
          </div>

          <div class="progress"><div class="bar" id="p1"></div></div>
          <div class="hint">Dica: o ‚Äúbot√£o proibido‚Äù libera um easter egg üò∂‚Äçüå´Ô∏è</div>
        </div>
      </section>

      <!-- S2: dados -->
      <section class="screen" id="s2">
        <div class="card">
          <div class="kicker">FORM ‚Üí dados_minimos()</div>
          <h2>Rapidinho‚Ä¶</h2>
          <p>Prometo n√£o parecer interrogat√≥rio. S√≥ preciso de alguns dados ‚Äúoficiais‚Äù.</p>

          <label>üë§ Nome <span class="tag">(obrigat√≥rio)</span></label>
          <input id="nome" placeholder="Digite seu nome‚Ä¶" value="">

          <label>üí¨ Apelido <span class="tag">(opcional)</span></label>
          <input id="apelido" placeholder="Ex: Loira‚Ä¶" value="">

          <label>‚ú® N√≠vel de beleza <span class="tag">(aceita: ‚àû)</span></label>
          <input id="beleza" placeholder="‚àû" value="">
          <div class="hint">Observa√ß√£o: o sistema √© exigente. Muito.</div>

          <div class="btns">
            <button class="primary" id="toQuiz">CONTINUAR</button>
            <button class="ghost" data-back="s1">VOLTAR</button>
          </div>
        </div>
      </section>

      <!-- S3: mini-quiz (mais etapas) -->
      <section class="screen" id="s3">
        <div class="card">
          <div class="kicker">CHECK ‚Üí calibrar_sorrisos()</div>
          <h2>Teste de humor (3 perguntas)</h2>
          <p>N√£o existe resposta certa‚Ä¶ s√≥ respostas que deixam isso mais fofo üòÑ</p>

          <label>1) Hoje voc√™ t√° mais‚Ä¶</label>
          <select id="q1">
            <option value="leve">Leve</option>
            <option value="s√©ria">S√©ria</option>
            <option value="cansada">Cansada</option>
            <option value="com_saudade">Com saudade de algu√©m üëÄ</option>
          </select>

          <label>2) Escolha um superpoder</label>
          <select id="q2">
            <option value="teletransporte">Teletransporte (pra encurtar dist√¢ncia)</option>
            <option value="parar_tempo">Parar o tempo (s√≥ pra conversar)</option>
            <option value="ler_mentes">Ler mentes (perigoso)</option>
            <option value="cura">Cura (pra cuidar de quem importa)</option>
          </select>

          <label>3) Voc√™ prefere uma coisa simples ou intensa?</label>
          <select id="q3">
            <option value="simples">Simples (mas de verdade)</option>
            <option value="intensa">Intensa (mas com calma)</option>
          </select>

          <div class="btns">
            <button class="primary" id="toScan">INICIAR SCANNER</button>
            <button class="ghost" data-back="s2">VOLTAR</button>
          </div>
        </div>
      </section>

      <!-- S4: scan (din√¢mico) -->
      <section class="screen" id="s4">
        <div class="card">
          <div class="kicker">SCAN ‚Üí detectar_importancia()</div>
          <h2>Escaneando‚Ä¶</h2>
          <p>Fica tranquila. Eu s√≥ t√¥ ‚Äúprovando‚Äù o que eu j√° sinto.</p>

          <div class="terminal">
            <div class="scanline"></div>
            <div id="term"></div>
          </div>

          <div class="progress"><div class="bar" id="p2"></div></div>

          <div class="btns">
            <button class="primary" id="toReport" disabled>VER RELAT√ìRIO</button>
          </div>
        </div>
      </section>

      <!-- S5: relat√≥rio -->
      <section class="screen" id="s5">
        <div class="card">
          <div class="kicker">REPORT ‚Üí matem√°tica_do_cora√ß√£o()</div>
          <h2>Relat√≥rio Oficial</h2>

          <div class="kpis">
            <div class="kpi">
              <div class="ico">üìà</div>
              <div>
                <b>Compatibilidade</b>
                <small><span id="pct">100%</span> (subindo‚Ä¶)</small>
              </div>
            </div>

            <div class="kpi">
              <div class="ico">üí´</div>
              <div>
                <b>Impacto</b>
                <small id="impact">alto‚Ä¶ e aumentando cada vez que voc√™ aparece.</small>
              </div>
            </div>

            <div class="kpi">
              <div class="ico">üîì</div>
              <div>
                <b>Resultado</b>
                <small>Acesso permitido para a loira mais linda do mundo</small>
              </div>
            </div>
          </div>

          <div class="btns">
            <button class="good" id="toFinal">DESBLOQUEAR FINAL ‚ú®</button>
            <button class="ghost" data-back="s4">VOLTAR</button>
          </div>
        </div>
      </section>

      <!-- S6: final cinematogr√°fico -->
      <section class="screen" id="s6">
        <div class="card">
          <div class="kicker">FINAL ‚Üí dizer_o_que_importa()</div>
          <h2 id="finalTitle">Loira‚Ä¶</h2>

          <!-- FRASE FINAL NOVA, IMPACTANTE, SEM NAMORO -->
          <p id="finalText">
            Eu fiz isso s√≥ pra te arrancar um sorriso‚Ä¶ mas tamb√©m pra te deixar uma verdade bem clara:
            <b>voc√™ √© importante pra mim de um jeito que eu n√£o sei fingir.</b><br><br>
            Eu n√£o quero que voc√™ saia da minha vida.  
            Se um dia voc√™ estiver bem, eu vou comemorar com voc√™.  
            Se estiver em um dia dif√≠cil, eu vou estar aqui do seu lado ‚Äî do meu jeito ‚Äî mas de verdade.<br><br>
            <b>Conta comigo.</b> Sempre.
          </p>

          <div class="btns">
            <button class="primary" id="play">‚ñ∂ TOCAR M√öSICA</button>
            <button class="ghost" id="reveal">‚ú® MOSTRAR SURPRESA</button>
          </div>
          <div class="hint">No celular, a m√∫sica s√≥ toca depois que tocar no bot√£o.</div>

          <!-- YouTube (revela no play) -->
          <div class="ytWrap" id="ytWrap">
            <iframe id="yt" src="" allow="autoplay; encrypted-media" allowfullscreen title="M√∫sica"></iframe>
          </div>

          <!-- fotos -->
          <div class="gallery">
            <div class="ph"><img src="./foto1.jpg" alt="Foto 1"><span>üì∏</span></div>
            <div class="ph"><img src="./foto2.jpg" alt="Foto 2"><span>üì∏</span></div>
            <div class="ph"><img src="./foto3.jpg" alt="Foto 3"><span>üì∏</span></div>
            <div class="ph"><img src="./foto4.jpg" alt="Foto 4"><span>üì∏</span></div>
          </div>

          <div class="btns" style="margin-top:14px">
            <button class="ghost" id="restart">REINICIAR</button>
            <button class="primary" id="shareTip">COMO ENVIAR</button>
          </div>
        </div>
      </section>
    </main>

    <footer>
      <span>¬© Dev do Crush</span>
      <span id="state">state=IDLE</span>
    </footer>
  </div>

  <!-- modal -->
  <div class="modal" id="modal">
    <div class="pop" id="pop">
      <header>
        <div class="head">
          <b id="mTitle">Aviso</b>
          <span id="mCode">SYS-000</span>
        </div>
      </header>
      <main>
        <p id="mMsg"></p>
        <div class="btns" style="margin-top:12px">
          <button class="primary" id="mOk">OK</button>
        </div>
      </main>
    </div>
  </div>

  <script>
    // M√∫sica do YouTube (a que j√° funcionou pra voc√™)
    const YT_ID = "wMne8UDPN7A";

    const screens = ["s1","s2","s3","s4","s5","s6"].reduce((a,id)=>(a[id]=document.getElementById(id),a),{});
    const st = document.getElementById("st");
    const state = document.getElementById("state");
    const sub = document.getElementById("sub");

    const p1 = document.getElementById("p1");
    const p2 = document.getElementById("p2");

    const nome = document.getElementById("nome");
    const apelido = document.getElementById("apelido");
    const beleza = document.getElementById("beleza");

    const q1 = document.getElementById("q1");
    const q2 = document.getElementById("q2");
    const q3 = document.getElementById("q3");

    const term = document.getElementById("term");
    const toReport = document.getElementById("toReport");

    const pct = document.getElementById("pct");
    const impact = document.getElementById("impact");

    const finalTitle = document.getElementById("finalTitle");
    const ytWrap = document.getElementById("ytWrap");
    const yt = document.getElementById("yt");

    // modal
    const modal = document.getElementById("modal");
    const pop = document.getElementById("pop");
    const mTitle = document.getElementById("mTitle");
    const mCode = document.getElementById("mCode");
    const mMsg = document.getElementById("mMsg");
    const mOk = document.getElementById("mOk");

    const session = { nome:"", apelido:"Loira", beleza:"‚àû", q1:"", q2:"", q3:"" };

    function setState(v){
      st.textContent = v;
      state.textContent = `state=${v}`;
    }
    function go(id){
      Object.values(screens).forEach(s=>s.classList.remove("active"));
      screens[id].classList.add("active");
      window.scrollTo({top:0, behavior:"smooth"});
    }

    function showModal(title, code, msg){
      mTitle.textContent = title;
      mCode.textContent = code;
      mMsg.innerHTML = msg;
      modal.classList.add("show");
      pop.classList.remove("shake");
      void pop.offsetWidth;
      pop.classList.add("shake");
    }
    function hideModal(){ modal.classList.remove("show"); }
    mOk.addEventListener("click", hideModal);
    modal.addEventListener("click", (e)=>{ if(e.target === modal) hideModal(); });

    document.querySelectorAll("[data-back]").forEach(b=>{
      b.addEventListener("click", ()=>go(b.getAttribute("data-back")));
    });

    function sleep(ms){ return new Promise(r=>setTimeout(r, ms)); }

    // easter egg
    document.getElementById("secret").addEventListener("click", ()=>{
      showModal("Bot√£o Proibido", "SYS-007",
        "‚úÖ <b>Modo fofura</b> ativado.<br><br>Voc√™ acabou de ganhar um elogio secreto: <b>voc√™ tem um jeito de melhorar o meu dia sem esfor√ßo</b>.");
    });

    // start
    setState("IDLE");
    p1.style.width = "8%";
    document.getElementById("start").addEventListener("click", async ()=>{
      setState("BOOTING");
      p1.style.width = "35%"; await sleep(180);
      p1.style.width = "62%"; await sleep(180);
      p1.style.width = "100%"; await sleep(160);
      setState("FORM");
      go("s2");
    });

    // to quiz
    document.getElementById("toQuiz").addEventListener("click", ()=>{
      const n = (nome.value||"").trim();
      if(!n){
        showModal("Erro de Entrada", "SYS-101", "Campo <b>Nome</b> √© obrigat√≥rio üòå");
        return;
      }
      session.nome = n;
      session.apelido = (apelido.value||"").trim() || "Loira";

      // beleza: pegadinha leve
      const b = (beleza.value||"").trim().toLowerCase();
      const ok = (b === "‚àû" || b === "infinito" || b === "infinita");
      if(!ok){
        showModal("ERRO CR√çTICO", "SYS-666",
          "Valor inv√°lido.<br><br>üîß Corre√ß√£o autom√°tica aplicada: <b>‚àû</b>.<br>Motivo: o sistema n√£o aceita beleza baixa.");
        beleza.value = "‚àû";
        return;
      }
      session.beleza = "‚àû";

      sub.textContent = `alvo: ${session.apelido} ‚Ä¢ protocolo: sorriso`;
      finalTitle.textContent = `${session.apelido}‚Ä¶`;

      setState("QUIZ");
      go("s3");
    });

    // to scan
    document.getElementById("toScan").addEventListener("click", ()=>{
      session.q1 = q1.value;
      session.q2 = q2.value;
      session.q3 = q3.value;

      setState("SCANNING");
      go("s4");
      startScan();
    });

    // scan dynamic
    async function startScan(){
      term.textContent = "";
      toReport.disabled = true;
      p2.style.width = "0%";

      const moodTxt = {
        leve: "leve",
        s√©ria: "s√©ria",
        cansada: "cansada",
        com_saudade: "com saudade"
      }[session.q1] || "leve";

      const powerTxt = {
        teletransporte: "teletransporte",
        parar_tempo: "parar o tempo",
        ler_mentes: "ler mentes",
        cura: "cura"
      }[session.q2] || "teletransporte";

      const styleTxt = {
        simples: "simples (mas de verdade)",
        intensa: "intensa (mas com calma)"
      }[session.q3] || "simples";

      const lines = [
        {t:`[SYS] Iniciando scanner‚Ä¶`, c:""},
        {t:`[DAT] Nome informado: ${session.nome}`, c:"ok"},
        {t:`[DAT] Apelido: ${session.apelido}`, c:"ok"},
        {t:`[DAT] Beleza: ${session.beleza} (confirmado pelo sistema).`, c:"ok"},
        {t:`[CHK] Humor do dia: ${moodTxt}`, c:"warn"},
        {t:`[CHK] Superpoder escolhido: ${powerTxt}`, c:"warn"},
        {t:`[CHK] Estilo: ${styleTxt}`, c:"warn"},
        {t:`[CHK] Procurando defeitos‚Ä¶`, c:""},
        {t:`[ERR] Nenhum defeito encontrado (0 resultados).`, c:"err"},
        {t:`[OK ] Detectado: presen√ßa que acalma + sorriso que bagun√ßa tudo.`, c:"ok"},
        {t:`[OK ] Compatibilidade subindo‚Ä¶`, c:"ok"},
      ];

      for(let i=0;i<lines.length;i++){
        const L = lines[i];
        appendLine(L.t, L.c);
        p2.style.width = `${Math.min(100, (i+1)* (100/lines.length))}%`;
        await sleep(330);
      }

      // set impact line with quiz flavor
      impact.textContent = (session.q2 === "cura")
        ? "voc√™ tem um jeito de cuidar do mundo‚Ä¶ e sem perceber, mexe com o meu."
        : "tem coisas em voc√™ que puxam a aten√ß√£o e seguram o cora√ß√£o.";

      await sleep(200);
      toReport.disabled = false;
      setState("REPORT");
    }

    function appendLine(text, cls=""){
      const div = document.createElement("div");
      div.className = `tag ${cls}`;
      div.textContent = text;
      term.appendChild(div);
    }

    // to report
    toReport.addEventListener("click", ()=>{
      go("s5");
      animatePct();
    });

    // 100% -> 1000%
    let pctTimer = null;
    function animatePct(){
      if(pctTimer) clearInterval(pctTimer);
      let v = 100;
      pct.textContent = `${v}%`;
      pctTimer = setInterval(()=>{
        const step = v < 500 ? 22 : v < 850 ? 16 : 12;
        v += step;
        if(v >= 1000){
          v = 1000;
          clearInterval(pctTimer);
          pctTimer = null;
        }
        pct.textContent = `${v}%`;
      }, 40);
    }

    // to final
    document.getElementById("toFinal").addEventListener("click", ()=>{
      setState("FINAL");
      go("s6");
    });

    // play music (reveal youtube)
    document.getElementById("play").addEventListener("click", ()=>{
      ytWrap.style.display = "block";
      yt.src = `https://www.youtube.com/embed/${YT_ID}?autoplay=1&playsinline=1&rel=0`;
    });

    // reveal surprise
    document.getElementById("reveal").addEventListener("click", ()=>{
      showModal("Surpresa", "SYS-LOVE",
        "Se voc√™ leu at√© aqui‚Ä¶ ent√£o deixa eu registrar oficialmente:<br><br>" +
        "<b>eu gosto de ter voc√™ por perto.</b><br>" +
        "E eu quero que isso continue ‚Äî do jeito leve, certo e verdadeiro.");
    });

    document.getElementById("restart").addEventListener("click", ()=>{
      yt.src = "";
      ytWrap.style.display = "none";
      setState("IDLE");
      p1.style.width = "8%";
      p2.style.width = "0%";
      pct.textContent = "100%";
      go("s1");
    });

    document.getElementById("shareTip").addEventListener("click", ()=>{
      showModal("Como enviar", "TIP-001",
        "Manda s√≥ o link e essa frase:<br><br>" +
        "‚ÄúFiz uma coisinha diferente pra voc√™‚Ä¶ abre com calma üíõ‚Äù<br><br>" +
        "Sem explicar. Sem spoiler. Deixa ela descobrir.");
    });
  </script>
</body>
</html>
